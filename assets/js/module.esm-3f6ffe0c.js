function b(l){l.directive("mask",(t,{value:e,expression:o},{effect:f,evaluateLater:s})=>{let n=()=>o,u="";if(["function","dynamic"].includes(e)){let r=s(o);f(()=>{n=c=>{let d;return l.dontAutoEvaluateFunctions(()=>{r(a=>{d=typeof a=="function"?a(c):a},{scope:{$input:c,$money:S.bind({el:t})}})}),d},i(t)})}else i(t);t.addEventListener("input",()=>i(t)),t.addEventListener("blur",()=>i(t,!1));function i(r,c=!0){let d=r.value,a=n(d);if(!a||a==="false")return!1;if(u.length-r.value.length===1)return u=r.value;let g=()=>{u=r.value=p(d,a)};c?I(r,a,()=>{g()}):g()}function p(r,c){if(r==="")return"";let d=h(c,r);return v(c,d)}})}function I(l,t,e){let o=l.selectionStart,f=l.value;e();let s=f.slice(0,o),n=v(t,h(t,s)).length;l.setSelectionRange(n,n)}function h(l,t){let e=t,o="",f={9:/[0-9]/,a:/[a-zA-Z]/,"*":/[a-zA-Z0-9]/},s="";for(let n=0;n<l.length;n++){if(["9","a","*"].includes(l[n])){s+=l[n];continue}for(let u=0;u<e.length;u++)if(e[u]===l[n]){e=e.slice(0,u)+e.slice(u+1);break}}for(let n=0;n<s.length;n++){let u=!1;for(let i=0;i<e.length;i++)if(f[s[n]].test(e[i])){o+=e[i],e=e.slice(0,i)+e.slice(i+1),u=!0;break}if(!u)break}return o}function v(l,t){let e=Array.from(t),o="";for(let f=0;f<l.length;f++){if(!["9","a","*"].includes(l[f])){o+=l[f];continue}if(e.length===0)break;o+=e.shift()}return o}function S(l,t=".",e){e=t===","&&e===void 0?".":",";let o=(n,u)=>{let i="",p=0;for(let r=n.length-1;r>=0;r--)n[r]!==u&&(p===3?(i=n[r]+u+i,p=0):i=n[r]+i,p++);return i},f=l.replaceAll(new RegExp(`[^0-9\\${t}]`,"g"),""),s=Array.from({length:f.split(t)[0].length}).fill("9").join("");return s=o(s,e),l.includes(t)&&(s+=`${t}99`),queueMicrotask(()=>{this.el.value.endsWith(t)||this.el.value[this.el.selectionStart-1]===t&&this.el.setSelectionRange(this.el.selectionStart-1,this.el.selectionStart-1)}),s}var k=b;export{k as m};
